	def dM_SiO2_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_SiO2 given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_SiO2*(M_Fe*(M_O*(M_MgO*(M_FeO*M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)))) + dKFeO_KFeO*(M_Mg*M_O*M_m*(-4.0*M_FeO*M_MgSiO3 + 4.0*M_FeSiO3*M_MgO) + M_Si*(M_Mg*(M_O*(M_FeO*(-6.0*M_MgSiO3 + 6.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 3.0*M_MgO + 15.0*M_m)) + M_m*(-M_FeO*M_MgSiO3 + M_FeSiO3*M_MgO)) + M_O*(M_MgO*(6.0*M_FeO*M_m + M_FeSiO3*(-9.0*M_FeO + 15.0*M_m)) + M_MgSiO3*(M_FeO*(-9.0*M_MgO + 6.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO + 15.0*M_m)))) + M_c*(M_Mg*(M_FeO*M_MgSiO3*M_m + M_FeSiO3*(-M_MgO*M_m + M_O*(M_FeO + M_MgO - M_m))) + M_O*(M_FeSiO3*M_MgO*(M_FeO - M_m) + M_MgSiO3*(M_FeO*M_MgO + M_FeSiO3*(M_FeO + M_MgO - M_m))) + M_Si*(M_Mg*(M_FeO*(2.0*M_MgSiO3 - 2.0*M_m) + M_FeSiO3*(4.0*M_FeO + 2.0*M_MgO - 6.0*M_m) + M_O*(M_FeO + M_FeSiO3)) + M_MgO*(-2.0*M_FeO*M_m + M_FeSiO3*(4.0*M_FeO - 6.0*M_m)) + M_MgSiO3*(M_FeO*(4.0*M_MgO - 2.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO - 6.0*M_m)) + M_O*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*M_m*(M_Fe*M_FeO*(4.0*M_MgO + 4.0*M_MgSiO3) + M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO) + M_FeO*(4.0*M_MgO + 4.0*M_MgSiO3))) + M_Si*(M_Fe*(M_FeO*M_m*(M_MgO + M_MgSiO3) + M_O*(M_MgO*(-3.0*M_FeO + 15.0*M_m) + M_MgSiO3*(-3.0*M_FeO - 9.0*M_MgO + 15.0*M_m))) + M_FeO*M_O*M_m*(9.0*M_MgO + 9.0*M_MgSiO3) + M_Mg*(M_Fe*(M_O*(-3.0*M_FeO - 3.0*M_MgO + 15.0*M_m) + M_m*(M_FeO + M_MgO)) + M_FeO*(M_O*(-3.0*M_MgO + 6.0*M_MgSiO3 + 9.0*M_m) + M_m*(M_MgO + M_MgSiO3)))) + M_c*(M_Fe*(M_FeO*M_m*(-M_MgO - M_MgSiO3) + M_O*(M_MgO*(M_FeO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m))) + M_FeO*M_O*M_m*(-M_MgO - M_MgSiO3) + M_Mg*(M_Fe*(M_O*(M_FeO + M_MgO - M_m) + M_m*(-M_FeO - M_MgO)) + M_FeO*(M_O*(M_MgO - M_m) + M_m*(-M_MgO - M_MgSiO3))) + M_Si*(M_Fe*(M_MgO*(2.0*M_FeO - 6.0*M_m) + M_MgSiO3*(2.0*M_FeO + 4.0*M_MgO - 6.0*M_m) + M_O*(M_MgO + M_MgSiO3)) + M_FeO*M_m*(-4.0*M_MgO - 4.0*M_MgSiO3) + M_Mg*(M_Fe*(2.0*M_FeO + 2.0*M_MgO + M_O - 6.0*M_m) + M_FeO*(2.0*M_MgO - 2.0*M_MgSiO3 - 4.0*M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_m*(M_FeO*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgO*(M_FeO*M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)))) + dKMgO_KMgO*(M_Fe*M_O*M_m*(4.0*M_FeO*M_MgSiO3 - 4.0*M_FeSiO3*M_MgO) + M_Si*(M_Fe*(M_O*(M_MgO*(-6.0*M_FeSiO3 + 6.0*M_m) + M_MgSiO3*(-3.0*M_FeO - 9.0*M_MgO + 15.0*M_m)) + M_m*(M_FeO*M_MgSiO3 - M_FeSiO3*M_MgO)) + M_O*(M_MgO*(6.0*M_FeO*M_m + M_FeSiO3*(-9.0*M_FeO + 6.0*M_m)) + M_MgSiO3*(M_FeO*(-9.0*M_MgO + 15.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO + 15.0*M_m)))) + M_c*(M_Fe*(M_FeSiO3*M_MgO*M_m + M_MgSiO3*(-M_FeO*M_m + M_O*(M_FeO + M_MgO - M_m))) + M_O*(M_FeO*M_FeSiO3*M_MgO + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m))) + M_Si*(M_Fe*(M_MgO*(2.0*M_FeSiO3 - 2.0*M_m) + M_MgSiO3*(2.0*M_FeO + 4.0*M_MgO - 6.0*M_m) + M_O*(M_MgO + M_MgSiO3)) + M_MgO*(-2.0*M_FeO*M_m + M_FeSiO3*(4.0*M_FeO - 2.0*M_m)) + M_MgSiO3*(M_FeO*(4.0*M_MgO - 6.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO - 6.0*M_m)) + M_O*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*M_m*(M_Fe*M_MgO*(4.0*M_FeO + 4.0*M_FeSiO3) + M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO) + M_MgO*(4.0*M_FeO + 4.0*M_FeSiO3))) + M_Si*(M_Mg*(M_Fe*(M_O*(-3.0*M_FeO - 3.0*M_MgO + 15.0*M_m) + M_m*(M_FeO + M_MgO)) + M_MgO*M_m*(M_FeO + M_FeSiO3) + M_O*(M_FeO*(-3.0*M_MgO + 15.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 3.0*M_MgO + 15.0*M_m))) + M_MgO*(M_Fe*(M_O*(-3.0*M_FeO + 6.0*M_FeSiO3 + 9.0*M_m) + M_m*(M_FeO + M_FeSiO3)) + M_O*M_m*(9.0*M_FeO + 9.0*M_FeSiO3))) + M_c*(M_Mg*(M_Fe*(M_O*(M_FeO + M_MgO - M_m) + M_m*(-M_FeO - M_MgO)) + M_MgO*M_m*(-M_FeO - M_FeSiO3) + M_O*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m))) + M_MgO*(M_Fe*(M_O*(M_FeO - M_m) + M_m*(-M_FeO - M_FeSiO3)) + M_O*M_m*(-M_FeO - M_FeSiO3)) + M_Si*(M_Mg*(M_Fe*(2.0*M_FeO + 2.0*M_MgO + M_O - 6.0*M_m) + M_FeO*(2.0*M_MgO - 6.0*M_m) + M_FeSiO3*(4.0*M_FeO + 2.0*M_MgO - 6.0*M_m) + M_O*(M_FeO + M_FeSiO3)) + M_MgO*(M_Fe*(2.0*M_FeO - 2.0*M_FeSiO3 - 4.0*M_m) + M_m*(-4.0*M_FeO - 4.0*M_FeSiO3))))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(-1.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er))) + M_O*(M_MgO*(M_FeO*(2*dM_FeO_er + 5.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_FeSiO3*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 16.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(2*dM_FeO_er + 5.0*dM_FeSiO3_er - 1.0*dM_MgO_er + 2.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_FeSiO3*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_MgO*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_m*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er + 9.0*dM_MgO_er - 9.0*dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_O*(M_FeO*(2*dM_FeO_er + 5.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_FeSiO3*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_MgO*(2*dM_FeO_er + 5.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_MgSiO3*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_m*(M_FeO*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_MgO*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_MgO*(M_FeO*M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(-1.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeO_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(2*dM_FeO_er + 5.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(-9.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er) + M_MgO*(-1.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(9.0*dM_FeO_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-10.0*dM_FeO_er - 16.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_FeSiO3*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*M_m*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_m*(9.0*dM_FeO_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_m*(-9.0*dM_FeSiO3_er + 9.0*dM_MgO_er - 9.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_MgO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_m*(9.0*dM_FeO_er + 9.0*dM_MgO_er - 9.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(-4.0*M_FeO*M_m + M_FeSiO3*(6.0*M_FeO - 10.0*M_m)) + M_MgSiO3*(M_FeO*(6.0*M_MgO - 4.0*M_m) + M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 10.0*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 10.0*M_m) + M_MgSiO3*(6.0*M_FeO + 6.0*M_MgO - 10.0*M_m) + M_m*(-4.0*M_FeO - 4.0*M_MgO)) + M_MgO*(-4.0*M_FeO*M_m + M_FeSiO3*(6.0*M_FeO - 4.0*M_m)) + M_MgSiO3*(M_FeO*(6.0*M_MgO - 10.0*M_m) + M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 10.0*M_m)))) + M_c*(M_Fe*(M_MgO*(M_FeO*M_m + M_FeSiO3*(-2.0*M_FeO + 3.0*M_m)) + M_MgSiO3*(M_FeO*(-2.0*M_MgO + M_m) + M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + 3.0*M_m)) + M_O*(M_MgO*(-M_FeO + M_m) + M_MgSiO3*(-M_FeO + M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + 3.0*M_m) + M_MgSiO3*(-2.0*M_FeO - 2.0*M_MgO + 3.0*M_m) + M_O*(-M_FeO - M_MgO + M_m) + M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_m + M_FeSiO3*(-2.0*M_FeO + M_m)) + M_MgSiO3*(M_FeO*(-2.0*M_MgO + 3.0*M_m) + M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + 3.0*M_m)) + M_O*(M_FeO*(-M_MgO + M_m) + M_FeSiO3*(-M_MgO + M_m))) + M_O*M_m*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3))))) + M_c*(M_Fe*(M_MgO*(M_FeO*M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er - dM_MgO_er + 1.0*dM_SiO2_er))) + M_O*(M_MgO*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er) + M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er - dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er - dM_MgO_er + 1.0*dM_SiO2_er)) + M_O*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_m*(M_FeO*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgO*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er))) + M_MgO*(M_FeO*M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_FeSiO3_er - dM_MgO_er + 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_FeO_er - dM_MgO_er + 1.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_MgO*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_MgO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_m*(-dM_FeO_er - dM_MgO_er + dM_SiO2_er)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(dM_FeO_er + 3.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 5.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_MgO*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_O*(M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_MgSiO3*(dM_MgO_er + dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_MgO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_MgSiO3*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_FeO*(M_MgO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_MgO*(1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(3.0*dM_FeO_er + 5.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_FeSiO3*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_O*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er))) + M_MgO*(M_FeO*M_m*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_FeO_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_MgO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er))) + M_O*(M_MgO*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_FeO_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_FeO given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_FeO*(M_Fe*(M_O*(M_MgO*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er))) + dKFeO_KFeO*(M_Mg*M_O*(M_MgO*(M_FeSiO3*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(M_MgO*(M_FeSiO3*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(9.0*M_MgO + 6.0*M_SiO2 - 15.0*M_m) + M_MgO*(M_SiO2 - 4.0*M_m) + M_MgSiO3*(9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) - 9.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(6.0*M_SiO2 - 15.0*M_m) - 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeSiO3*(6.0*M_SiO2 - 15.0*M_m) + M_MgO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_MgO*(M_FeSiO3*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(-M_MgO + M_m) + M_MgSiO3*(-M_MgO + M_m) + M_SiO2*(-M_MgO + M_m))) + M_O*(M_MgO*M_m*(M_FeSiO3 + M_SiO2) + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_m*(M_FeSiO3 + M_SiO2))) + M_Si*(M_Mg*(M_FeSiO3*(-4.0*M_MgO - 2.0*M_SiO2 + 6.0*M_m) + M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_MgO - M_MgSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_MgO*(M_FeSiO3*(-2.0*M_SiO2 + 6.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeSiO3*(-2.0*M_SiO2 + 6.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + M_m)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*(M_Fe*(4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Mg*(M_MgSiO3*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_Fe + 4.0*M_MgO))) + M_Si*(M_Fe*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgO*(2.0*M_SiO2 + 10.0*M_m) + M_MgSiO3*(-9.0*M_MgO + 2.0*M_SiO2 + 10.0*M_m))) + M_Mg*(M_Fe*(M_O*(2.0*M_SiO2 + 10.0*M_m) + M_SiO2*M_m) + M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m)) + M_O*(9.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_c*(M_Fe*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(M_O + M_SiO2 - M_m) - M_SiO2*M_m)) + M_Mg*(M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_MgSiO3*(M_MgO - M_m) + M_SiO2*(M_MgO - M_m)) + M_SiO2*M_m*(-M_Fe - M_MgO)) + M_O*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_Si*(M_Fe*(M_MgO*(-M_SiO2 - 3.0*M_m) + M_MgSiO3*(4.0*M_MgO - M_SiO2 - 3.0*M_m) + M_O*(M_MgO + M_MgSiO3)) + M_Mg*(M_Fe*(M_O - M_SiO2 - 3.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) - 4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgO*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er))) + dKMgO_KMgO*(M_Fe*M_O*(M_MgO*(M_FeSiO3*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(M_MgO*(M_FeSiO3*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgO*(-9.0*M_FeSiO3 - M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_MgO + 2.0*M_SiO2 + 10.0*M_m))) + M_FeSiO3*M_O*(M_MgO*(-3.0*M_SiO2 - 6.0*M_m) + M_MgSiO3*(6.0*M_SiO2 - 15.0*M_m))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(M_SiO2 - M_m) + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2) - M_SiO2*M_m) + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_FeSiO3*M_O*(M_MgO*M_SiO2 + M_MgSiO3*M_m) + M_Si*(M_Fe*(M_MgO*(4.0*M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(4.0*M_MgO - M_SiO2 - 3.0*M_m) + M_O*(M_MgO + M_MgSiO3)) + M_FeSiO3*(M_MgO*(2.0*M_SiO2 + 2.0*M_m) + M_MgSiO3*(-2.0*M_SiO2 + 6.0*M_m)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*(M_Fe*M_FeSiO3*M_MgO*(4.0*M_SiO2 - 4.0*M_m) + M_Mg*(4.0*M_Fe*M_SiO2*M_m + M_FeSiO3*M_MgO*(4.0*M_SiO2 - 4.0*M_m))) + M_Si*(M_Mg*(M_Fe*(M_O*(2.0*M_SiO2 + 10.0*M_m) + M_SiO2*M_m) + M_FeSiO3*(M_MgO*(M_SiO2 - M_m) + M_O*(9.0*M_MgO + 6.0*M_SiO2 - 15.0*M_m))) + M_MgO*(M_Fe*(M_FeSiO3*(M_SiO2 - M_m) + M_O*(9.0*M_FeSiO3 + 3.0*M_SiO2 + 6.0*M_m)) + M_FeSiO3*M_O*(9.0*M_SiO2 - 9.0*M_m))) + M_c*(M_Mg*(-M_Fe*M_SiO2*M_m + M_FeSiO3*(M_MgO*(-M_SiO2 + M_m) + M_O*(-M_MgO + M_m))) + M_MgO*(M_Fe*(M_FeSiO3*(-M_SiO2 + M_m) + M_O*(-M_FeSiO3 - M_SiO2)) + M_FeSiO3*M_O*(-M_SiO2 + M_m)) + M_Si*(M_Mg*(M_Fe*(M_O - M_SiO2 - 3.0*M_m) + M_FeSiO3*(-4.0*M_MgO - 2.0*M_SiO2 + 6.0*M_m)) + M_MgO*(M_Fe*(-4.0*M_FeSiO3 - 2.0*M_SiO2 - 2.0*M_m) + M_FeSiO3*(-4.0*M_SiO2 + 4.0*M_m))))) + M_Si*(M_Fe*(M_MgO*(M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(1.0*dM_FeO_er + 1.0*dM_FeSiO3_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 15.0*dM_MgO_er - 24.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-2*dM_FeO_er - 5.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_MgSiO3*(M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_MgO*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(-2*dM_FeO_er - 5.0*dM_FeSiO3_er - 3.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er + 6.0*dM_MgO_er - 6.0*dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_O*(M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_MgSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-2*dM_FeO_er - 5.0*dM_FeSiO3_er - 2*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgO*(M_FeSiO3*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-1.0*dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_SiO2*M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_O*(M_FeSiO3*(M_MgO*(3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-9.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeO_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-25.0*dM_FeO_er - 25.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er))) + M_O*(M_MgO*(M_FeSiO3*(M_SiO2*(-9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 18.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeO_er + 9.0*dM_MgSiO3_er + 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeO_er - 9.0*dM_MgO_er + 9.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m) + 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m) + M_MgO*(-6.0*M_SiO2 + 6.0*M_m) + 6.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m) + M_MgSiO3*(-4.0*M_SiO2 + 10.0*M_m) + 6.0*M_SiO2*M_m) + M_FeSiO3*(M_MgO*(2.0*M_SiO2 + 4.0*M_m) + M_MgSiO3*(-4.0*M_SiO2 + 10.0*M_m)))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(M_SiO2 - 3.0*M_m) - 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeSiO3*(M_SiO2 - 3.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeSiO3 + M_SiO2) + M_MgSiO3*(M_FeSiO3 + M_SiO2))) + M_FeSiO3*M_O*(M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - M_m)) + M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2 - 3.0*M_m) + M_MgSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_MgO*(-M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_MgO + M_MgSiO3 + M_SiO2 - M_m)))))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 1.0*dM_FeSiO3_er) + M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeSiO3*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_O*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgO*(M_FeSiO3*(M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_O*(M_FeSiO3*(M_MgO*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_MgSiO3*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)))) + M_O*(M_MgO*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er))) + M_Si*(M_Fe*(M_MgO*(M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(dM_FeO_er + 3.0*dM_FeSiO3_er + 2*dM_MgO_er + 4.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_MgO*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 3.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er - 2.0*dM_MgO_er + 2.0*dM_SiO2_er)) + M_O*(M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_MgSiO3*(dM_MgO_er + dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_MgSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeSiO3*(M_MgO*(-2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er)) + M_O*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_MgSiO3*(-dM_FeO_er - dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgO*(M_FeSiO3*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeSiO3*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_Fe_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_Fe given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_Fe*(M_FeSiO3*dKFeSiO3_KFeSiO3*(M_Mg*M_O*(4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-3.0*M_SiO2 - 6.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-3.0*M_SiO2 - 6.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-3.0*M_SiO2 - 6.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_c*(M_Mg*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m))) + M_O*(M_MgO*M_SiO2*(M_FeO - M_m) + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) + M_SiO2*(M_FeO - M_m))) + M_Si*(M_Mg*(M_FeO*(2.0*M_SiO2 + 2.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgO*(M_FeO*(2.0*M_SiO2 + 2.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 2.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - M_m))))) + M_Mg*(M_O*(M_FeSiO3*(M_FeO*(M_SiO2*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(M_FeO*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er))) + dKMgO_KMgO*(M_O*(M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m))) + M_Si*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO - 2.0*M_SiO2 - 10.0*M_m)) + M_MgSiO3*(M_FeO*(9.0*M_MgO - 2.0*M_SiO2 - 10.0*M_m) + M_FeSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m)))) + M_c*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*M_MgO*(-M_FeSiO3 - M_SiO2) + M_MgSiO3*(-M_FeO*M_MgO + M_FeSiO3*(-M_FeO - M_MgO + M_m))) + M_Si*(M_MgO*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO + M_SiO2 + 3.0*M_m)) + M_MgSiO3*(M_FeO*(-4.0*M_MgO + M_SiO2 + 3.0*M_m) + M_FeSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m)) + M_O*(M_MgO*(-M_FeO - M_FeSiO3) + M_MgSiO3*(-M_FeO - M_FeSiO3)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_Mg*M_O*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(-2.0*M_SiO2 - 10.0*M_m) + M_FeSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m))) + M_MgO*M_O*(M_FeO*(-3.0*M_SiO2 - 6.0*M_m) + M_FeSiO3*(6.0*M_SiO2 - 15.0*M_m))) + M_c*(M_Mg*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_O*(-M_FeO - M_MgO + M_m) + M_SiO2*M_m)) + M_MgO*M_O*(M_FeO*M_SiO2 + M_FeSiO3*M_m) + M_Si*(M_Mg*(M_FeO*(M_SiO2 + 3.0*M_m) + M_FeSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_FeO - M_FeSiO3)) + M_MgO*(M_FeO*(2.0*M_SiO2 + 2.0*M_m) + M_FeSiO3*(-2.0*M_SiO2 + 6.0*M_m))))) + M_Si*(M_Mg*(M_FeSiO3*(M_FeO*(M_SiO2*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(1.0*dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-1.0*dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_SiO2*M_m*(1.0*dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_SiO2*M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_O*(M_FeO*(M_SiO2*(3.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(6.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_MgO*(3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-6.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-15.0*dM_FeO_er + 10.0*dM_MgO_er + 25.0*dM_MgSiO3_er + 15.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(15.0*dM_FeO_er + 24.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-25.0*dM_FeO_er - 25.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_SiO2*M_m*(M_FeO*(1.0*dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er))) + M_O*(M_MgO*(M_FeO*(M_SiO2*(3.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(6.0*dM_FeSiO3_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 12.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-15.0*dM_FeO_er + 15.0*dM_MgSiO3_er + 15.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(3.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 3.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(6.0*dM_FeSiO3_er - 6.0*dM_MgO_er + 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_FeSiO3_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-15.0*dM_FeO_er - 15.0*dM_MgO_er + 15.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er))) + dKSiO2_KSiO2*(M_O*(M_Mg*(M_FeO*(M_MgSiO3*(4.0*M_SiO2 - 10.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgO*(-6.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_FeO*(M_MgSiO3*(-M_SiO2 + 3.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-M_SiO2 - M_m) + 2.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_MgSiO3 - M_SiO2) + M_FeSiO3*(M_MgO - M_m))) + M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_O*(M_MgO*(-M_FeO*M_SiO2 - M_FeSiO3*M_m) + M_MgSiO3*(-M_FeO*M_SiO2 - M_FeSiO3*M_m))))) + M_c*(M_Mg*(M_FeSiO3*(M_FeO*(M_SiO2*(dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*M_m*(-dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(1.0*dM_FeSiO3_er - dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_O*(M_FeSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er) + M_MgO*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er))) + M_SiO2*M_m*(M_FeO*(-dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + dM_FeSiO3_er))) + M_O*(M_MgO*(M_FeSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeO_er + dM_FeSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er))) + M_Si*(M_Mg*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_MgO*(-2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(2.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er - 3.0*dM_MgO_er - 9.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(-6.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er)) + M_O*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er) + M_FeSiO3*(-dM_FeO_er - dM_FeSiO3_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_MgSiO3*(-dM_FeO_er - dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgO*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2*dM_MgO_er + 4.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er + 6.0*dM_MgO_er - 6.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er))))) + dKFeO_KFeO*(M_Mg*M_O*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Si*(M_Mg*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Mg*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Mg*(M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_FeSiO3_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_FeSiO3 given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_FeSiO3*(M_Fe*(M_O*(M_MgO*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er))) + dKFeO_KFeO*(M_Mg*M_O*(-4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(3.0*M_SiO2 + 6.0*M_m) + M_MgO*(M_SiO2 - 4.0*M_m) + M_MgSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) - 9.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(3.0*M_SiO2 + 6.0*M_m) - 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(3.0*M_SiO2 + 6.0*M_m) + M_MgO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgSiO3*(-M_FeO - M_MgO + M_m) + M_SiO2*(-M_FeO - M_MgO + M_m))) + M_O*(M_MgO*M_SiO2*(-M_FeO + M_m) + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*(-M_FeO + M_m))) + M_Si*(M_Mg*(M_FeO*(-2.0*M_SiO2 - 2.0*M_m) + M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_MgO - M_MgSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_MgO*(M_FeO*(-2.0*M_SiO2 - 2.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-2.0*M_SiO2 - 2.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + M_m)))))) + M_Mg*(M_O*(M_Fe*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgO*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er))) + dKMgO_KMgO*(M_Fe*M_O*(4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgO*(2.0*M_SiO2 + 10.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m))) + M_FeO*M_O*(M_MgO*(3.0*M_SiO2 + 6.0*M_m) + M_MgSiO3*(-6.0*M_SiO2 + 15.0*M_m))) + M_c*(M_Fe*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) - M_SiO2*M_m)) + M_FeO*M_O*(-M_MgO*M_SiO2 - M_MgSiO3*M_m) + M_Si*(M_Fe*(M_MgO*(-M_SiO2 - 3.0*M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_MgO + M_MgSiO3)) + M_FeO*(M_MgO*(-2.0*M_SiO2 - 2.0*M_m) + M_MgSiO3*(2.0*M_SiO2 - 6.0*M_m)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*(M_Fe*M_FeO*M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + M_Mg*(M_Fe*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeO*M_MgO*(-4.0*M_SiO2 + 4.0*M_m))) + M_Si*(M_Mg*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_O*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_O*(-9.0*M_MgO - 6.0*M_SiO2 + 15.0*M_m))) + M_MgO*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_O*(-9.0*M_FeO - 6.0*M_SiO2 + 15.0*M_m)) + M_FeO*M_O*(-9.0*M_SiO2 + 9.0*M_m))) + M_c*(M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) - M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) + M_O*(M_MgO - M_m))) + M_MgO*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_O*(M_FeO - M_m)) + M_FeO*M_O*(M_SiO2 - M_m)) + M_Si*(M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO + M_O + M_SiO2 - 9.0*M_m) + M_FeO*(4.0*M_MgO + 2.0*M_SiO2 - 6.0*M_m)) + M_MgO*(M_Fe*(4.0*M_FeO + 2.0*M_SiO2 - 6.0*M_m) + M_FeO*(4.0*M_SiO2 - 4.0*M_m))))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(1.0*dM_FeO_er + 1.0*dM_FeSiO3_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 12.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 15.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er - 3.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_MgO*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er + 15.0*dM_MgO_er - 15.0*dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_O*(M_FeO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgO*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_SiO2*M_m*(-dM_FeO_er - dM_FeSiO3_er)) + M_O*(M_FeO*(M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(9.0*dM_FeO_er + 18.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + dM_FeSiO3_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(15.0*dM_FeO_er + 24.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_m*(-25.0*dM_FeO_er - 25.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er))) + M_O*(M_MgO*(M_FeO*(M_SiO2*(9.0*dM_FeO_er + 18.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 18.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(9.0*dM_FeO_er + 18.0*dM_FeSiO3_er + 9.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeSiO3_er + 9.0*dM_MgO_er - 9.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er) + M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(M_FeO*(-2.0*M_SiO2 - 4.0*M_m) + 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-2.0*M_SiO2 - 4.0*M_m) + M_MgO*(-6.0*M_SiO2 + 6.0*M_m) + 6.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeO*(-2.0*M_SiO2 - 4.0*M_m) + M_MgO*(-2.0*M_SiO2 - 4.0*M_m) + 6.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-2.0*M_SiO2 - 4.0*M_m) + M_MgSiO3*(4.0*M_SiO2 - 10.0*M_m)))) + M_c*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 + M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_FeO + M_m) + M_MgSiO3*(-M_FeO + M_m))) + M_FeO*M_O*(M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + M_m)) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_MgO*(M_SiO2 + M_m) + M_O*(-M_FeO - M_MgO + M_m) - 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + 3.0*M_m) + M_O*(-M_MgO - M_MgSiO3 - M_SiO2 + M_m)))))) + M_c*(M_Fe*(M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 1.0*dM_FeSiO3_er) + M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er) + M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_O*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(1.0*dM_FeSiO3_er - dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_O*(M_FeO*(M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)))) + M_O*(M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + dM_FeSiO3_er))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er - 6.0*dM_MgO_er + 6.0*dM_SiO2_er)) + M_O*(M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_MgSiO3*(dM_MgO_er + dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_FeO*(M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(-6.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er)) + M_O*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er) + M_MgSiO3*(-dM_FeO_er - dM_FeSiO3_er) + M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgO*(M_FeO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er)) + M_MgSiO3*(M_SiO2*(-dM_FeO_er - dM_FeSiO3_er) + M_m*(dM_FeO_er + dM_FeSiO3_er))))) + dKFeSiO3_KFeSiO3*(M_O*(M_Fe*M_FeO*(-4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_MgSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_SiO2*M_m*(-4.0*M_FeO - 4.0*M_MgO)) + M_FeO*(-4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_FeO*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - 4.0*M_m) - 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(9.0*M_MgO + M_SiO2 - 4.0*M_m) + M_MgO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m))) + M_FeO*M_O*(-9.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - 4.0*M_m) + M_MgSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) - 9.0*M_SiO2*M_m) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_FeO*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_MgO*(M_SiO2 - 4.0*M_m) + M_MgSiO3*(9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) - 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_FeO*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*M_SiO2*(-M_FeO + M_m) + M_MgSiO3*(M_FeO*(-M_MgO - M_SiO2) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m))) + M_FeO*M_O*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_Mg*(M_Fe*(M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgSiO3*(-M_FeO - M_MgO + M_m) + M_SiO2*(-M_FeO - M_MgO + M_m)) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_FeO*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_MgSiO3*(-M_MgO + M_m) + M_SiO2*(-M_MgO + M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(-M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_MgO - M_SiO2 + M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_FeO - M_SiO2 + M_m) + M_MgSiO3*(-M_FeO - M_SiO2 + M_m))) + M_FeO*(4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + M_m))) + M_Mg*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_FeO - M_MgO - M_MgSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_MgSiO3*(-4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_MgO - M_MgSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_O_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_O given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_O*(M_Fe*dKFeO_KFeO*(M_Si*(M_Mg*(M_FeO*(M_MgSiO3*(2.0*M_SiO2 - 5.0*M_m) - 3.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_MgO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m)) + M_MgO*(-3.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_FeO*M_m*(-M_MgSiO3 - M_SiO2) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m))) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_Si*(M_Mg*(M_FeO*(-2.0*M_MgSiO3 - M_SiO2 - M_m) + M_FeSiO3*(2.0*M_MgO + M_SiO2 - 3.0*M_m)) + M_MgO*(M_FeO*(-M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m)) + M_MgSiO3*(M_FeO*(-M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 + 2.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 + 2.0*M_m) + M_MgO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + 2.0*M_m) + M_MgSiO3*(-2.0*M_SiO2 + 5.0*M_m)))) + M_c*(M_Fe*(M_MgO*M_SiO2*(M_FeO - M_m) + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) + M_SiO2*(M_FeO - M_m))) + M_Mg*(M_Fe*M_SiO2*(M_FeO + M_MgO - M_m) + M_FeO*(M_MgO*M_SiO2 + M_MgSiO3*M_m)) + M_Si*(M_Fe*(M_MgO*(2.0*M_FeO + M_SiO2 - 3.0*M_m) + M_MgSiO3*(2.0*M_FeO + M_SiO2 - 3.0*M_m)) + M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) + M_MgSiO3*(2.0*M_SiO2 - 2.0*M_m)) + M_Mg*(M_Fe*(2.0*M_FeO + 2.0*M_MgO + M_SiO2 - 3.0*M_m) + M_FeO*(2.0*M_MgO + 2.0*M_MgSiO3 + 2.0*M_SiO2 - 2.0*M_m))))) + M_Mg*dKMgO_KMgO*(M_Si*(M_Fe*(M_MgO*(M_FeSiO3*(2.0*M_SiO2 - 5.0*M_m) - 3.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 + 2.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m)) + M_MgO*(-3.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m))) + M_c*(M_Fe*(M_MgO*M_m*(-M_FeSiO3 - M_SiO2) + M_MgSiO3*(M_MgO*(M_SiO2 - M_m) + M_SiO2*(M_FeO - M_m))) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_Si*(M_Fe*(M_MgO*(-2.0*M_FeSiO3 - M_SiO2 - M_m) + M_MgSiO3*(2.0*M_FeO + M_SiO2 - 3.0*M_m)) + M_MgO*(M_FeO*(-M_SiO2 - M_m) + M_FeSiO3*(-M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - 3.0*M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_Si*(M_Fe*M_MgO*(M_FeO*(M_SiO2 + 2.0*M_m) + M_FeSiO3*(-2.0*M_SiO2 + 5.0*M_m)) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 + 2.0*M_m) + M_MgO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_MgO*(M_SiO2 + 2.0*M_m) - 3.0*M_SiO2*M_m))) + M_c*(M_Fe*M_MgO*(M_FeO*M_SiO2 + M_FeSiO3*M_m) + M_Mg*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_SiO2*(M_Fe*(M_FeO + M_MgO - M_m) + M_FeO*(M_MgO - M_m))) + M_Si*(M_Mg*(M_Fe*(2.0*M_FeO + 2.0*M_MgO + M_SiO2 - 3.0*M_m) + M_FeO*(2.0*M_MgO + M_SiO2 - 3.0*M_m) + M_FeSiO3*(2.0*M_MgO + M_SiO2 - 3.0*M_m)) + M_MgO*(M_Fe*(2.0*M_FeO + 2.0*M_FeSiO3 + 2.0*M_SiO2 - 2.0*M_m) + M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_FeSiO3*(2.0*M_SiO2 - 2.0*M_m))))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 4.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(5.0*dM_FeO_er - 5.0*dM_MgSiO3_er - 5.0*dM_SiO2_er)) + M_SiO2*M_m*(3.0*dM_FeO_er + 3.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(5.0*dM_FeO_er + 5.0*dM_MgO_er - 5.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er) + M_m*(3.0*dM_FeO_er + 3.0*dM_FeSiO3_er)) + M_SiO2*M_m*(3.0*dM_FeO_er + 3.0*dM_FeSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(5.0*dM_FeO_er + 5.0*dM_MgO_er - 5.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(5.0*dM_FeO_er + 5.0*dM_MgO_er - 5.0*dM_SiO2_er)) + M_SiO2*M_m*(3.0*dM_FeO_er + 3.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 3.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_SiO2*M_m*(3.0*dM_MgO_er + 3.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(-3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_m*(3.0*dM_MgO_er + 3.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(2.0*dM_FeO_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_SiO2*M_m*(3.0*dM_MgO_er + 3.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(-5.0*dM_FeSiO3_er + 5.0*dM_MgO_er - 5.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_MgO*(-3.0*dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 3.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(5.0*dM_FeO_er + 5.0*dM_MgO_er - 5.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_Fe*(M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_SiO2*M_m*(2.0*M_FeO + 2.0*M_MgO)) + M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(2.0*M_FeO - 3.0*M_m) + M_SiO2*(M_FeO - 2.0*M_m)) + M_MgSiO3*(M_FeO*(2.0*M_MgO + M_SiO2) + M_FeSiO3*(2.0*M_FeO + 2.0*M_MgO - 3.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeSiO3*(2.0*M_FeO + 2.0*M_MgO - 3.0*M_m) + M_MgSiO3*(2.0*M_FeO + 2.0*M_MgO - 3.0*M_m) + M_SiO2*(M_FeO + M_MgO - 2.0*M_m)) + M_FeO*M_SiO2*(M_MgO - 2.0*M_m) + M_FeSiO3*(M_FeO*(2.0*M_MgO + 2.0*M_SiO2 - 2.0*M_m) + M_SiO2*(M_MgO - 2.0*M_m)) + M_MgSiO3*(M_FeO*(2.0*M_MgO - 3.0*M_m) + M_FeSiO3*(2.0*M_FeO + 2.0*M_MgO - 3.0*M_m))) + M_MgO*(-2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m))))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(M_FeO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 1.0*dM_FeSiO3_er) + M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_MgO*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er))) + M_FeO*M_SiO2*(M_MgO*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_SiO2*(M_MgO*(-1.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(-1.0*dM_FeSiO3_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er + 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er - 2.0*dM_MgO_er + 2.0*dM_SiO2_er))) + M_Mg*(M_Fe*(M_FeO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_MgO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_MgSiO3*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeO*(M_MgO*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeSiO3*(M_MgO*(1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_SiO2*(-2.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeO_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-3.0*dM_FeO_er - 5.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_FeSiO3*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er))) + M_MgO*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-2.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeO_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeSiO3_er - 2.0*dM_MgO_er + 2.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeO_er - 2.0*dM_MgO_er + 2.0*dM_SiO2_er))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_Si_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_Si given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_Si*(M_Fe*(M_O*(M_MgO*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er - 10.0*dM_MgSiO3_er - 10.0*dM_SiO2_er)) + M_SiO2*M_m*(6.0*dM_FeO_er + 6.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er + 10.0*dM_MgO_er - 10.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er) + M_m*(6.0*dM_FeO_er + 6.0*dM_FeSiO3_er)) + M_SiO2*M_m*(6.0*dM_FeO_er + 6.0*dM_FeSiO3_er))) + dKFeO_KFeO*(M_O*(M_Mg*(M_FeO*(M_MgSiO3*(4.0*M_SiO2 - 10.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgO*(-6.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_FeO*(M_MgSiO3*(-M_SiO2 + 3.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-M_SiO2 - M_m) + 2.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_MgSiO3 - M_SiO2) + M_FeSiO3*(M_MgO - M_m))) + M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_O*(M_MgO*(-M_FeO*M_SiO2 - M_FeSiO3*M_m) + M_MgSiO3*(-M_FeO*M_SiO2 - M_FeSiO3*M_m))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*(M_Fe*(M_MgO*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m) + M_FeO*(M_MgO*(2.0*M_SiO2 + 4.0*M_m) + M_MgSiO3*(-4.0*M_SiO2 + 10.0*M_m)))) + M_c*(M_Fe*(M_MgO*(M_FeO*(-M_SiO2 - M_m) + 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 - M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO - M_m) + M_MgSiO3*(M_FeO - M_m))) + M_FeO*M_O*(M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - M_m)) + M_Mg*(M_Fe*(M_FeO*(-M_SiO2 - M_m) + M_MgO*(-M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) + 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 - M_m) + M_MgSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_MgO + M_MgSiO3 + M_SiO2 - M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er + 10.0*dM_MgO_er - 10.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er + 10.0*dM_MgO_er - 10.0*dM_SiO2_er)) + M_SiO2*M_m*(6.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 6.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(6.0*dM_MgO_er + 6.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_m*(6.0*dM_MgO_er + 6.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-2.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(6.0*dM_MgO_er + 6.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-10.0*dM_FeSiO3_er + 10.0*dM_MgO_er - 10.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_MgO*(-6.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 6.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er + 10.0*dM_MgO_er - 10.0*dM_SiO2_er)))) + dKMgO_KMgO*(M_O*(M_Fe*(M_MgO*(M_FeSiO3*(4.0*M_SiO2 - 10.0*M_m) - 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgO*(-6.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(-M_SiO2 + 3.0*M_m) + 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 - M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_FeSiO3 - M_SiO2) + M_MgSiO3*(M_FeO - M_m))) + M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_O*(M_MgO*M_SiO2*(-M_FeO - M_FeSiO3) + M_MgSiO3*M_m*(-M_FeO - M_FeSiO3))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*(M_Fe*M_MgO*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m)) + M_Mg*(M_Fe*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m) + M_FeO*(M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(2.0*M_SiO2 + 4.0*M_m) - 6.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_Fe*(M_FeO*(-M_SiO2 - M_m) + M_MgO*(-M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) + 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 - M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-M_SiO2 - M_m) + 2.0*M_SiO2*M_m) + M_O*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_MgO - M_m))) + M_MgO*(M_Fe*(M_FeO*(-M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_SiO2 - M_m)) + M_O*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))) + M_c*(M_Fe*(M_MgO*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-3.0*dM_FeO_er + 3.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_SiO2*M_m*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er) + M_m*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_FeSiO3*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er) + M_FeSiO3*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)) + M_O*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_FeSiO3*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgSiO3*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(-2.0*dM_MgO_er - 2.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_m*(-2.0*dM_MgO_er - 2.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(-2.0*dM_MgO_er - 2.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(3.0*dM_FeSiO3_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_MgO*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_MgO*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_FeSiO3*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er - dM_MgO_er + dM_SiO2_er))))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_c_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_c given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_c*(M_Fe*(M_O*(M_MgO*(M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(-2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er)) + M_SiO2*M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er))) + dKFeO_KFeO*(M_O*(M_Mg*(M_FeO*M_m*(-2.0*M_MgSiO3 - 2.0*M_SiO2) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_SiO2*(2.0*M_MgO - 2.0*M_m))) + M_MgO*(-2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m))) + M_Si*(M_Mg*(M_FeO*(M_MgSiO3*(M_SiO2 - 3.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_O*(M_FeO*(-3.0*M_MgSiO3 - M_SiO2 - 2.0*M_m) + M_FeSiO3*(3.0*M_MgO + 2.0*M_SiO2 - 5.0*M_m))) + M_MgO*(-2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 - 2.0*M_m) + M_FeSiO3*(2.0*M_SiO2 - 5.0*M_m)) + M_MgSiO3*(M_FeO*(-M_SiO2 - 2.0*M_m) + M_FeSiO3*(2.0*M_SiO2 - 5.0*M_m)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*(M_Fe*(M_MgO*M_SiO2*(2.0*M_FeO - 2.0*M_m) + M_MgSiO3*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) + M_SiO2*(2.0*M_FeO - 2.0*M_m))) + M_Mg*(M_Fe*M_SiO2*(2.0*M_FeO + 2.0*M_MgO - 2.0*M_m) + M_FeO*(2.0*M_MgO*M_SiO2 + 2.0*M_MgSiO3*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 + M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_O*(M_MgO*(3.0*M_FeO + 2.0*M_SiO2 - 5.0*M_m) + M_MgSiO3*(3.0*M_FeO + 2.0*M_SiO2 - 5.0*M_m))) + M_FeO*M_O*(M_MgO*(3.0*M_SiO2 - 3.0*M_m) + M_MgSiO3*(3.0*M_SiO2 - 3.0*M_m)) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_MgO*(M_SiO2 + M_m) + M_O*(3.0*M_FeO + 3.0*M_MgO + 2.0*M_SiO2 - 5.0*M_m) - 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + M_m) + M_MgSiO3*(-M_SiO2 + 3.0*M_m) + M_O*(3.0*M_MgO + 3.0*M_MgSiO3 + 3.0*M_SiO2 - 3.0*M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_MgO*(-2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er))) + M_FeO*M_SiO2*(M_MgO*(-2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(-2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_SiO2*(M_MgO*(-2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(-2.0*dM_FeSiO3_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_MgO_er - 2.0*dM_SiO2_er)))) + dKMgO_KMgO*(M_O*(M_Fe*(M_MgO*M_m*(-2.0*M_FeSiO3 - 2.0*M_SiO2) + M_MgSiO3*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) + M_SiO2*(2.0*M_FeO - 2.0*M_m))) + M_MgO*(-2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeSiO3*(M_SiO2 - 3.0*M_m) - 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 + M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_O*(M_MgO*(-3.0*M_FeSiO3 - M_SiO2 - 2.0*M_m) + M_MgSiO3*(3.0*M_FeO + 2.0*M_SiO2 - 5.0*M_m))) + M_MgO*(-2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 - 2.0*M_m) + M_FeSiO3*(-M_SiO2 - 2.0*M_m)) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 - 5.0*M_m) + M_FeSiO3*(2.0*M_SiO2 - 5.0*M_m)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*(M_Fe*M_MgO*(2.0*M_FeO*M_SiO2 + 2.0*M_FeSiO3*M_m) + M_Mg*(M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_SiO2*(2.0*M_MgO - 2.0*M_m)) + M_SiO2*(M_Fe*(2.0*M_FeO + 2.0*M_MgO - 2.0*M_m) + M_FeO*(2.0*M_MgO - 2.0*M_m)))) + M_Si*(M_Mg*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_MgO*(M_SiO2 + M_m) + M_O*(3.0*M_FeO + 3.0*M_MgO + 2.0*M_SiO2 - 5.0*M_m) - 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_O*(M_FeO*(3.0*M_MgO + 2.0*M_SiO2 - 5.0*M_m) + M_FeSiO3*(3.0*M_MgO + 2.0*M_SiO2 - 5.0*M_m))) + M_MgO*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + 3.0*M_m) + M_O*(3.0*M_FeO + 3.0*M_FeSiO3 + 3.0*M_SiO2 - 3.0*M_m)) + M_O*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_FeSiO3*(3.0*M_SiO2 - 3.0*M_m))))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + dM_SiO2_er) + M_m*(3.0*dM_FeO_er - 3.0*dM_MgSiO3_er - 3.0*dM_SiO2_er)) + M_SiO2*M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 3.0*dM_MgO_er - 3.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er) + M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er)) + M_SiO2*M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er)) + M_O*(M_MgO*(M_FeO*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_FeSiO3*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 5.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_SiO2*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 5.0*dM_FeSiO3_er + 3.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er + dM_MgO_er - 2.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_FeSiO3*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_SiO2*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 3.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 5.0*dM_FeSiO3_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 3.0*dM_MgO_er - 3.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 3.0*dM_MgO_er - 3.0*dM_SiO2_er)) + M_O*(M_FeO*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_FeSiO3*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_MgO*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_MgSiO3*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_SiO2*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 5.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_SiO2*M_m*(2.0*dM_FeO_er + 2.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(-2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er)) + M_SiO2*M_m*(2.0*dM_MgO_er + 2.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(-3.0*dM_FeSiO3_er + 3.0*dM_MgO_er - 3.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 2.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 3.0*dM_MgO_er - 3.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_SiO2*(-3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(3.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_FeSiO3*(M_MgO*(dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_SiO2*(-3.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-3.0*dM_FeO_er + 2.0*dM_MgO_er + 5.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-5.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_FeSiO3*(-2.0*dM_FeO_er - 5.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*(M_SiO2*(-3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(3.0*dM_FeSiO3_er + 3.0*dM_MgSiO3_er + 3.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-3.0*dM_FeSiO3_er - 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-3.0*dM_FeO_er + 3.0*dM_MgSiO3_er + 3.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_SiO2*(-3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 3.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(3.0*dM_FeSiO3_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-3.0*dM_FeSiO3_er - 3.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 3.0*dM_MgO_er + 3.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(3.0*M_FeO - 5.0*M_m) + M_SiO2*(M_FeO - 3.0*M_m)) + M_MgSiO3*(M_FeO*(3.0*M_MgO + M_SiO2) + M_FeSiO3*(3.0*M_FeO + 3.0*M_MgO - 5.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(3.0*M_FeO + 3.0*M_MgO - 5.0*M_m) + M_MgSiO3*(3.0*M_FeO + 3.0*M_MgO - 5.0*M_m) + M_SiO2*(M_FeO + M_MgO - 3.0*M_m)) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - 3.0*M_m) + M_FeSiO3*(M_FeO*(3.0*M_MgO + 3.0*M_SiO2 - 3.0*M_m) + M_SiO2*(M_MgO - 3.0*M_m)) + M_MgSiO3*(M_FeO*(3.0*M_MgO - 5.0*M_m) + M_FeSiO3*(3.0*M_FeO + 3.0*M_MgO - 5.0*M_m)))) + M_O*(M_MgO*(-3.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(3.0*M_SiO2 - 3.0*M_m) + M_MgO*(3.0*M_SiO2 - 3.0*M_m) - 3.0*M_SiO2*M_m))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_m_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_m given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_m*(M_Fe*(M_O*(M_MgO*(M_FeO*M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)))) + dKFeO_KFeO*(M_Mg*M_O*M_SiO2*(-4.0*M_FeO*M_MgSiO3 + 4.0*M_FeSiO3*M_MgO) + M_Si*(M_Mg*(M_O*(M_FeO*(-15.0*M_MgSiO3 - 3.0*M_SiO2) + M_FeSiO3*(-9.0*M_FeO + 6.0*M_MgO + 6.0*M_SiO2)) + M_SiO2*(-M_FeO*M_MgSiO3 + M_FeSiO3*M_MgO)) + M_O*(M_MgO*(-3.0*M_FeO*M_SiO2 + M_FeSiO3*(-9.0*M_FeO + 6.0*M_SiO2)) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 3.0*M_SiO2) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO + 6.0*M_SiO2)))) + M_c*(M_Mg*(M_FeO*(M_MgSiO3*M_SiO2 + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2)) - M_FeSiO3*M_MgO*M_SiO2) + M_O*(M_FeO*M_MgO*(M_FeSiO3 + M_SiO2) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO))) + M_Si*(M_Mg*(M_FeO*(6.0*M_MgSiO3 + 2.0*M_SiO2) + M_FeSiO3*(4.0*M_FeO - 2.0*M_MgO - 2.0*M_SiO2) + M_O*(M_FeO + M_FeSiO3)) + M_MgO*(2.0*M_FeO*M_SiO2 + M_FeSiO3*(4.0*M_FeO - 2.0*M_SiO2)) + M_MgSiO3*(M_FeO*(4.0*M_MgO + 2.0*M_SiO2) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO - 2.0*M_SiO2)) + M_O*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*M_SiO2*(M_Fe*M_FeO*(4.0*M_MgO + 4.0*M_MgSiO3) + M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO) + M_FeO*(4.0*M_MgO + 4.0*M_MgSiO3))) + M_Si*(M_Fe*(M_FeO*M_SiO2*(M_MgO + M_MgSiO3) + M_O*(M_MgO*(6.0*M_FeO + 6.0*M_SiO2) + M_MgSiO3*(6.0*M_FeO - 9.0*M_MgO + 6.0*M_SiO2))) + M_FeO*M_O*M_SiO2*(9.0*M_MgO + 9.0*M_MgSiO3) + M_Mg*(M_Fe*(M_O*(6.0*M_FeO + 6.0*M_MgO + 6.0*M_SiO2) + M_SiO2*(M_FeO + M_MgO)) + M_FeO*(M_O*(6.0*M_MgO + 15.0*M_MgSiO3 + 9.0*M_SiO2) + M_SiO2*(M_MgO + M_MgSiO3)))) + M_c*(M_Fe*(-M_FeO*M_MgO*M_SiO2 + M_MgSiO3*(-M_FeO*M_SiO2 + M_MgO*M_O)) + M_FeO*M_O*M_SiO2*(-M_MgO - M_MgSiO3) + M_Mg*(M_Fe*M_SiO2*(-M_FeO - M_MgO) + M_FeO*(M_O*(-M_MgSiO3 - M_SiO2) + M_SiO2*(-M_MgO - M_MgSiO3))) + M_Si*(M_Fe*(M_MgO*(-2.0*M_FeO - 2.0*M_SiO2) + M_MgSiO3*(-2.0*M_FeO + 4.0*M_MgO - 2.0*M_SiO2) + M_O*(M_MgO + M_MgSiO3)) + M_FeO*M_SiO2*(-4.0*M_MgO - 4.0*M_MgSiO3) + M_Mg*(M_Fe*(-2.0*M_FeO - 2.0*M_MgO + M_O - 2.0*M_SiO2) + M_FeO*(-2.0*M_MgO - 6.0*M_MgSiO3 - 4.0*M_SiO2))))) + M_Mg*(M_O*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgO*(M_FeO*M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)))) + dKMgO_KMgO*(M_Fe*M_O*M_SiO2*(4.0*M_FeO*M_MgSiO3 - 4.0*M_FeSiO3*M_MgO) + M_Si*(M_Fe*(M_O*(M_MgO*(-15.0*M_FeSiO3 - 3.0*M_SiO2) + M_MgSiO3*(6.0*M_FeO - 9.0*M_MgO + 6.0*M_SiO2)) + M_SiO2*(M_FeO*M_MgSiO3 - M_FeSiO3*M_MgO)) + M_O*(M_MgO*(-3.0*M_FeO*M_SiO2 + M_FeSiO3*(-9.0*M_FeO - 3.0*M_SiO2)) + M_MgSiO3*(M_FeO*(-9.0*M_MgO + 6.0*M_SiO2) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO + 6.0*M_SiO2)))) + M_c*(M_Fe*(-M_FeO*M_MgSiO3*M_SiO2 + M_MgO*(M_FeSiO3*M_SiO2 + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2))) + M_O*(M_MgO*(M_FeO*M_SiO2 + M_FeSiO3*(M_FeO + M_SiO2)) + M_MgSiO3*(M_FeO*M_MgO + M_FeSiO3*(M_FeO + M_MgO))) + M_Si*(M_Fe*(M_MgO*(6.0*M_FeSiO3 + 2.0*M_SiO2) + M_MgSiO3*(-2.0*M_FeO + 4.0*M_MgO - 2.0*M_SiO2) + M_O*(M_MgO + M_MgSiO3)) + M_MgO*(2.0*M_FeO*M_SiO2 + M_FeSiO3*(4.0*M_FeO + 2.0*M_SiO2)) + M_MgSiO3*(M_FeO*(4.0*M_MgO - 2.0*M_SiO2) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO - 2.0*M_SiO2)) + M_O*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*M_SiO2*(M_Fe*M_MgO*(4.0*M_FeO + 4.0*M_FeSiO3) + M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO) + M_MgO*(4.0*M_FeO + 4.0*M_FeSiO3))) + M_Si*(M_Mg*(M_Fe*(M_O*(6.0*M_FeO + 6.0*M_MgO + 6.0*M_SiO2) + M_SiO2*(M_FeO + M_MgO)) + M_MgO*M_SiO2*(M_FeO + M_FeSiO3) + M_O*(M_FeO*(6.0*M_MgO + 6.0*M_SiO2) + M_FeSiO3*(-9.0*M_FeO + 6.0*M_MgO + 6.0*M_SiO2))) + M_MgO*(M_Fe*(M_O*(6.0*M_FeO + 15.0*M_FeSiO3 + 9.0*M_SiO2) + M_SiO2*(M_FeO + M_FeSiO3)) + M_O*M_SiO2*(9.0*M_FeO + 9.0*M_FeSiO3))) + M_c*(M_Mg*(M_FeSiO3*(M_FeO*M_O - M_MgO*M_SiO2) + M_SiO2*(M_Fe*(-M_FeO - M_MgO) - M_FeO*M_MgO)) + M_MgO*(M_Fe*(M_O*(-M_FeSiO3 - M_SiO2) + M_SiO2*(-M_FeO - M_FeSiO3)) + M_O*M_SiO2*(-M_FeO - M_FeSiO3)) + M_Si*(M_Mg*(M_Fe*(-2.0*M_FeO - 2.0*M_MgO + M_O - 2.0*M_SiO2) + M_FeO*(-2.0*M_MgO - 2.0*M_SiO2) + M_FeSiO3*(4.0*M_FeO - 2.0*M_MgO - 2.0*M_SiO2) + M_O*(M_FeO + M_FeSiO3)) + M_MgO*(M_Fe*(-2.0*M_FeO - 6.0*M_FeSiO3 - 4.0*M_SiO2) + M_SiO2*(-4.0*M_FeO - 4.0*M_FeSiO3))))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-1.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_O*(M_MgO*(M_FeO*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_FeSiO3*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 25.0*dM_MgO_er - 40.0*dM_MgSiO3_er - 15.0*dM_SiO2_er) + M_SiO2*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 18.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er + 2.0*dM_MgO_er - 4.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_FeSiO3*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er) + M_MgO*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_O*(M_FeO*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_FeSiO3*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er) + M_MgO*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_MgSiO3*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er) + M_SiO2*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er))) + M_MgO*(M_FeO*M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_MgO*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_SiO2*(-9.0*dM_FeO_er - 18.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er) + M_MgO*(2.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_SiO2*(-9.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-25.0*dM_FeO_er - 40.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er) + M_FeSiO3*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*M_SiO2*(-9.0*dM_FeO_er - 18.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 18.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(-9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 18.0*dM_MgSiO3_er - 9.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(-9.0*dM_FeO_er - 18.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_MgO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er - 9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_SiO2*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(2.0*M_FeO*M_SiO2 + M_FeSiO3*(6.0*M_FeO - 4.0*M_SiO2)) + M_MgSiO3*(M_FeO*(6.0*M_MgO + 2.0*M_SiO2) + M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 4.0*M_SiO2))) + M_Mg*(M_Fe*(M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 4.0*M_SiO2) + M_MgSiO3*(6.0*M_FeO + 6.0*M_MgO - 4.0*M_SiO2) + M_SiO2*(2.0*M_FeO + 2.0*M_MgO)) + M_MgO*(2.0*M_FeO*M_SiO2 + M_FeSiO3*(6.0*M_FeO + 2.0*M_SiO2)) + M_MgSiO3*(M_FeO*(6.0*M_MgO - 4.0*M_SiO2) + M_FeSiO3*(6.0*M_FeO + 6.0*M_MgO - 4.0*M_SiO2)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2 + M_FeSiO3*(-2.0*M_FeO + M_SiO2)) + M_MgSiO3*(M_FeO*(-2.0*M_MgO - M_SiO2) + M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + M_SiO2)) + M_O*(M_MgO*(M_FeSiO3 + M_SiO2) + M_MgSiO3*(M_FeSiO3 + M_SiO2))) + M_Mg*(M_Fe*(M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + M_SiO2) + M_MgSiO3*(-2.0*M_FeO - 2.0*M_MgO + M_SiO2) + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2) + M_SiO2*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2 + M_FeSiO3*(-2.0*M_FeO - M_SiO2)) + M_MgSiO3*(M_FeO*(-2.0*M_MgO + M_SiO2) + M_FeSiO3*(-2.0*M_FeO - 2.0*M_MgO + M_SiO2)) + M_O*(M_MgSiO3*(M_FeO + M_FeSiO3) + M_SiO2*(M_FeO + M_FeSiO3))) + M_O*M_SiO2*(M_MgO*(M_FeO + M_FeSiO3) + M_MgSiO3*(M_FeO + M_FeSiO3))))) + M_c*(M_Fe*(M_MgO*(M_FeO*M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er))) + M_O*(M_MgO*(M_FeSiO3*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_O*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*(M_FeO*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_MgO*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er))) + M_MgO*(M_FeO*M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_MgO*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er))) + M_O*(M_FeO*M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_O*(M_MgO*(M_FeO*M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_MgO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_FeSiO3*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_SiO2*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + 3.0*dM_FeSiO3_er - 1.0*dM_MgO_er + 1.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_FeSiO3*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_MgO*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_O*(M_MgO*(dM_MgO_er + dM_MgSiO3_er) + M_MgSiO3*(dM_MgO_er + dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_FeSiO3*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_MgO*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_MgSiO3*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_SiO2*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_FeO*(M_MgO*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_MgO*(-1.0*dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(9.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_FeSiO3*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_O*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er))) + M_MgO*(M_FeO*M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er))) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_MgO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er))) + M_O*(M_MgO*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er + dM_MgO_er + dM_MgSiO3_er))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_MgO_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_MgO given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_MgO*(M_Fe*(M_O*(M_FeO*M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)))) + dKFeO_KFeO*(M_Mg*M_O*(M_FeO*(M_MgSiO3*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(M_FeO*(M_MgSiO3*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-9.0*M_MgSiO3 - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO + 2.0*M_SiO2 + 10.0*M_m))) + M_MgSiO3*M_O*(M_FeO*(-3.0*M_SiO2 - 6.0*M_m) + M_FeSiO3*(6.0*M_SiO2 - 15.0*M_m))) + M_c*(M_Mg*(M_FeO*(M_MgSiO3*(M_SiO2 - M_m) + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*M_O*(M_FeO*M_SiO2 + M_FeSiO3*M_m) + M_Si*(M_Mg*(M_FeO*(4.0*M_MgSiO3 + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO - M_SiO2 - 3.0*M_m) + M_O*(M_FeO + M_FeSiO3)) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 2.0*M_m) + M_FeSiO3*(-2.0*M_SiO2 + 6.0*M_m)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*(M_Fe*M_FeO*M_MgSiO3*(4.0*M_SiO2 - 4.0*M_m) + M_Mg*(4.0*M_Fe*M_SiO2*M_m + M_FeO*M_MgSiO3*(4.0*M_SiO2 - 4.0*M_m))) + M_Si*(M_Mg*(M_Fe*(M_O*(2.0*M_SiO2 + 10.0*M_m) + M_SiO2*M_m) + M_FeO*(M_MgSiO3*(M_SiO2 - M_m) + M_O*(9.0*M_MgSiO3 + 3.0*M_SiO2 + 6.0*M_m))) + M_MgSiO3*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_O*(9.0*M_FeO + 6.0*M_SiO2 - 15.0*M_m)) + M_FeO*M_O*(9.0*M_SiO2 - 9.0*M_m))) + M_c*(M_Mg*(-M_Fe*M_SiO2*M_m + M_FeO*(M_MgSiO3*(-M_SiO2 + M_m) + M_O*(-M_MgSiO3 - M_SiO2))) + M_MgSiO3*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_O*(-M_FeO + M_m)) + M_FeO*M_O*(-M_SiO2 + M_m)) + M_Si*(M_Mg*(M_Fe*(M_O - M_SiO2 - 3.0*M_m) + M_FeO*(-4.0*M_MgSiO3 - 2.0*M_SiO2 - 2.0*M_m)) + M_MgSiO3*(M_Fe*(-4.0*M_FeO - 2.0*M_SiO2 + 6.0*M_m) + M_FeO*(-4.0*M_SiO2 + 4.0*M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeO*M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)))) + dKMgO_KMgO*(M_Fe*M_O*(M_FeO*(M_MgSiO3*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(M_FeO*(M_MgSiO3*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO + 4.0*M_SiO2 - 25.0*M_m) + M_MgSiO3*(9.0*M_FeO + 6.0*M_SiO2 - 15.0*M_m) - 9.0*M_SiO2*M_m)) + M_O*(-9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(6.0*M_SiO2 - 15.0*M_m) + M_FeSiO3*(6.0*M_SiO2 - 15.0*M_m)))) + M_c*(M_Fe*(M_FeO*(M_MgSiO3*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(-M_FeO + M_m) + M_MgSiO3*(-M_FeO + M_m) + M_SiO2*(-M_FeO + M_m))) + M_O*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_m*(M_FeO*M_SiO2 + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_Si*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO - M_SiO2 + 9.0*M_m) + M_MgSiO3*(-4.0*M_FeO - 2.0*M_SiO2 + 6.0*M_m) + M_O*(-M_FeO - M_FeSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + 4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-2.0*M_SiO2 + 6.0*M_m) + M_FeSiO3*(-2.0*M_SiO2 + 6.0*M_m)) + M_O*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + M_m)))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_O*(M_Fe*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Mg*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_Fe + 4.0*M_FeO))) + M_Si*(M_Fe*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_O*(2.0*M_SiO2 + 10.0*M_m) + M_SiO2*M_m) + M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(2.0*M_SiO2 + 10.0*M_m) + M_FeSiO3*(-9.0*M_FeO + 2.0*M_SiO2 + 10.0*M_m))) + M_O*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_c*(M_Fe*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m))) + M_Mg*(M_FeSiO3*(M_FeO*(M_O + M_SiO2 - M_m) - M_SiO2*M_m) + M_SiO2*M_m*(-M_Fe - M_FeO)) + M_O*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_Si*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) - 4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_Mg*(M_Fe*(M_O - M_SiO2 - 3.0*M_m) + M_FeO*(-M_SiO2 - 3.0*M_m) + M_FeSiO3*(4.0*M_FeO - M_SiO2 - 3.0*M_m) + M_O*(M_FeO + M_FeSiO3)) + M_O*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))) + M_Si*(M_Fe*(M_FeO*M_SiO2*M_m*(-dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_SiO2*M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(1.0*dM_FeSiO3_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er))) + M_O*(M_FeO*(M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-25.0*dM_MgO_er - 25.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er + 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er - 9.0*dM_MgO_er + 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_O*(M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_MgSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_SiO2*(-2*dM_FeO_er - 5.0*dM_FeSiO3_er - 2*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_FeO*M_SiO2*M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(1.0*dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_SiO2*M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(1.0*dM_FeSiO3_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-1.0*dM_FeO_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er))) + M_O*(M_FeO*(M_SiO2*(-3.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(-6.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er) + M_SiO2*(-3.0*dM_FeSiO3_er - 2*dM_MgO_er - 5.0*dM_MgSiO3_er - 3.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er - 4.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 6.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-15.0*dM_FeO_er - 24.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_FeSiO3*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 15.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)))) + M_O*(M_FeO*M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-9.0*dM_FeO_er - 18.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(9.0*dM_FeSiO3_er - 9.0*dM_MgO_er + 9.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeO_er - 9.0*dM_MgO_er + 9.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_O*(M_Fe*M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m)) + M_Mg*(M_Fe*(M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m) + M_MgSiO3*(-4.0*M_SiO2 + 10.0*M_m) + 6.0*M_SiO2*M_m) + 6.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-6.0*M_SiO2 + 6.0*M_m) + 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 10.0*M_m) + M_FeSiO3*(-4.0*M_SiO2 + 10.0*M_m)))) + M_c*(M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2 - 3.0*M_m) + M_MgSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_FeSiO3 + M_MgSiO3 + M_SiO2) - 2.0*M_SiO2*M_m) - 2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) - 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - 3.0*M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m)) + M_O*(M_MgSiO3*(M_FeO + M_FeSiO3) + M_SiO2*(M_FeO + M_FeSiO3))) + M_MgSiO3*(M_Fe*(M_FeO*(-M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - 3.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_SiO2 - M_m)) + M_O*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)))))) + M_c*(M_Fe*(M_FeO*M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er))) + M_O*(M_FeSiO3*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er) + M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)))) + M_Mg*(M_Fe*(M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_MgSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_O*(M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_MgSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_FeO*M_SiO2*M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_SiO2*M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er + dM_MgO_er - 1.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - 1.0*dM_SiO2_er))) + M_O*(M_FeO*M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgSiO3*(M_FeO*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_FeSiO3*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_O*(M_FeO*M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er) + M_m*(dM_FeO_er + dM_MgO_er - dM_SiO2_er)))) + M_Si*(M_Fe*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_O*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_FeO*M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_FeSiO3*(M_FeO*(M_SiO2*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_Mg*(M_Fe*(M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_MgSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_SiO2*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(dM_FeO_er + 3.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeO*(M_SiO2*(2*dM_FeO_er + 4.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeO_er + dM_MgO_er + 3.0*dM_MgSiO3_er + 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(6.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_FeSiO3*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 2.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_O*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er))) + M_MgSiO3*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er)) + M_FeSiO3*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_MgO_er - 4.0*dM_SiO2_er))) + M_O*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_MgSiO3_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_MgSiO3 given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_MgSiO3*(M_Fe*(M_O*(M_FeO*(M_MgO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er))) + dKFeO_KFeO*(M_Mg*M_O*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Mg*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(2.0*M_SiO2 + 10.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m))) + M_MgO*M_O*(M_FeO*(3.0*M_SiO2 + 6.0*M_m) + M_FeSiO3*(-6.0*M_SiO2 + 15.0*M_m))) + M_c*(M_Mg*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) - M_SiO2*M_m)) + M_MgO*M_O*(-M_FeO*M_SiO2 - M_FeSiO3*M_m) + M_Si*(M_Mg*(M_FeO*(-M_SiO2 - 3.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3)) + M_MgO*(M_FeO*(-2.0*M_SiO2 - 2.0*M_m) + M_FeSiO3*(2.0*M_SiO2 - 6.0*M_m)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_O*(M_Fe*M_FeO*M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + M_Mg*(M_Fe*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeO*M_MgO*(-4.0*M_SiO2 + 4.0*M_m))) + M_Si*(M_Mg*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_O*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_O*(-9.0*M_MgO - 6.0*M_SiO2 + 15.0*M_m))) + M_MgO*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_O*(-9.0*M_FeO - 6.0*M_SiO2 + 15.0*M_m)) + M_FeO*M_O*(-9.0*M_SiO2 + 9.0*M_m))) + M_c*(M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) + M_O*(M_FeO + M_MgO - M_m) - M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) + M_O*(M_MgO - M_m))) + M_MgO*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_O*(M_FeO - M_m)) + M_FeO*M_O*(M_SiO2 - M_m)) + M_Si*(M_Mg*(M_Fe*(4.0*M_FeO + 4.0*M_MgO + M_O + M_SiO2 - 9.0*M_m) + M_FeO*(4.0*M_MgO + 2.0*M_SiO2 - 6.0*M_m)) + M_MgO*(M_Fe*(4.0*M_FeO + 2.0*M_SiO2 - 6.0*M_m) + M_FeO*(4.0*M_SiO2 - 4.0*M_m))))) + M_Mg*(M_O*(M_Fe*(M_FeO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(4.0*dM_FeO_er + 8.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er))) + dKMgO_KMgO*(M_Fe*M_O*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) + M_MgO*(3.0*M_SiO2 + 6.0*M_m) - 9.0*M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(3.0*M_SiO2 + 6.0*M_m) - 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(9.0*M_SiO2 - 9.0*M_m) + M_MgO*(3.0*M_SiO2 + 6.0*M_m) - 9.0*M_SiO2*M_m))) + M_c*(M_Fe*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(-M_FeO - M_MgO + M_m) + M_SiO2*(-M_FeO - M_MgO + M_m))) + M_O*(M_FeO*M_SiO2*(-M_MgO + M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*(-M_MgO + M_m))) + M_Si*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_MgO*(-2.0*M_SiO2 - 2.0*M_m) + M_O*(-M_FeO - M_FeSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-2.0*M_SiO2 - 2.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-2.0*M_SiO2 - 2.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + M_m)))))) + M_Si*(M_Fe*(M_FeO*(M_MgO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_MgO*(M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(1.0*dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_O*(M_FeO*(M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 15.0*dM_MgO_er + 24.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-25.0*dM_MgO_er - 25.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 18.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_O*(M_FeO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(4.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(-10.0*dM_FeO_er - 25.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er - 1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(dM_FeO_er + 2*dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(-1.0*dM_FeSiO3_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(1.0*dM_MgO_er + 1.0*dM_MgSiO3_er) + M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(dM_FeSiO3_er + dM_MgO_er + 2*dM_MgSiO3_er + dM_SiO2_er) + M_m*(1.0*dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-1.0*dM_MgO_er - 1.0*dM_MgSiO3_er)) + M_O*(M_FeO*(M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(6.0*dM_FeO_er + 12.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(-15.0*dM_FeSiO3_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-9.0*dM_FeO_er - 9.0*dM_FeSiO3_er) + M_MgO*(-3.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 6.0*dM_MgO_er + 15.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(6.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 10.0*dM_MgSiO3_er + 6.0*dM_SiO2_er) + M_m*(15.0*dM_FeO_er - 10.0*dM_MgO_er - 25.0*dM_MgSiO3_er - 15.0*dM_SiO2_er)))) + M_O*(M_FeO*(M_MgO*(M_SiO2*(9.0*dM_FeO_er + 18.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 18.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(-9.0*dM_FeSiO3_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 18.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_m*(9.0*dM_FeO_er - 9.0*dM_MgSiO3_er - 9.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er))) + dKSiO2_KSiO2*(M_O*(M_Fe*M_MgO*(M_FeO*(-2.0*M_SiO2 - 4.0*M_m) + M_FeSiO3*(4.0*M_SiO2 - 10.0*M_m)) + M_Mg*(M_Fe*(M_FeO*(-2.0*M_SiO2 - 4.0*M_m) + M_MgO*(-2.0*M_SiO2 - 4.0*M_m) + 6.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-2.0*M_SiO2 - 4.0*M_m) + 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-6.0*M_SiO2 + 6.0*M_m) + M_MgO*(-2.0*M_SiO2 - 4.0*M_m) + 6.0*M_SiO2*M_m))) + M_c*(M_Mg*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_MgO*(M_SiO2 + M_m) + M_O*(-M_FeO - M_MgO + M_m) - 2.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(2.0*M_SiO2 - 2.0*M_m) + M_MgO*(M_SiO2 + M_m) - 2.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_MgO + M_m) + M_FeSiO3*(-M_MgO + M_m))) + M_MgO*(M_Fe*(M_FeO*(M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + 3.0*M_m) + M_O*(-M_FeO - M_FeSiO3 - M_SiO2 + M_m)) + M_O*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + M_m)))))) + M_c*(M_Fe*(M_FeO*(M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_O*(M_FeO*(M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_O*(M_FeO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_FeO_er + 1.0*dM_FeSiO3_er + dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-dM_FeO_er - 2.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - 1.0*dM_MgSiO3_er) + M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-1.0*dM_FeSiO3_er - dM_MgO_er - 2.0*dM_MgSiO3_er - 1.0*dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + 1.0*dM_MgSiO3_er)) + M_O*(M_FeO*(M_MgO*(-dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_FeSiO3*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_MgO*(dM_FeO_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)))) + M_O*(M_FeO*(M_MgO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_FeSiO3_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + dM_MgSiO3_er + dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er))) + M_Si*(M_Fe*(M_FeO*(M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_O*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_SiO2*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 8.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(-4.0*dM_FeO_er + 4.0*dM_MgSiO3_er + 4.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_Mg*(M_Fe*(M_FeO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(3.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_FeO*(M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(6.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er) + M_MgO*(2.0*dM_FeO_er - 2.0*dM_FeSiO3_er - 2.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-2.0*dM_FeSiO3_er - dM_MgO_er - 3.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-6.0*dM_FeO_er + 3.0*dM_MgO_er + 9.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_O*(M_FeO*(dM_FeO_er + dM_FeSiO3_er) + M_FeSiO3*(dM_FeO_er + dM_FeSiO3_er))) + M_O*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er))))) + dKMgSiO3_KMgSiO3*(M_O*(M_Fe*M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_SiO2*M_m*(-4.0*M_FeO - 4.0*M_MgO)) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)))) + M_Si*(M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m) + M_MgO*(M_SiO2 - 4.0*M_m) - 9.0*M_SiO2*M_m) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(M_SiO2 - 4.0*M_m) - 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(9.0*M_MgO + 9.0*M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - 4.0*M_m) - 9.0*M_SiO2*M_m))) + M_MgO*(M_Fe*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO + 4.0*M_SiO2 - 25.0*M_m) - 9.0*M_SiO2*M_m)) + M_O*(-9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(9.0*M_SiO2 - 9.0*M_m) - 9.0*M_SiO2*M_m)))) + M_c*(M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(-M_FeO - M_MgO + M_m) + M_SiO2*(-M_FeO - M_MgO + M_m)) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(-M_MgO + M_m) + M_FeSiO3*(M_FeO*(-M_MgO - M_SiO2 + M_m) + M_SiO2*(-M_MgO + M_m)))) + M_MgO*(M_Fe*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeSiO3*(-M_FeO + M_m) + M_SiO2*(-M_FeO + M_m))) + M_O*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m))) + M_Si*(M_Mg*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + M_m) + M_O*(-M_FeO - M_FeSiO3 - M_MgO - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(-M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_MgO - 4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_MgO - M_SiO2 + M_m) + M_FeSiO3*(-M_MgO - M_SiO2 + M_m))) + M_MgO*(M_Fe*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO - M_SiO2 + 9.0*M_m) + M_O*(-M_FeO - M_FeSiO3 - M_SiO2 + M_m) + 4.0*M_SiO2*M_m) + 4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-M_SiO2 + M_m)))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

	def dM_Mg_dTc(self, Moles, dKs, dMi_b):
		'''compute dM_Mg given Moles, dKDs, and dMm_b/dT'''
		dM_MgO_er, dM_SiO2_er, dM_FeO_er, dM_MgSiO3_er, dM_FeSiO3_er = dMi_b
		M_Mg, M_Si, M_Fe, M_O, M_c, M_MgO, M_SiO2, M_FeO, M_MgSiO3, M_FeSiO3, M_m = self.unwrap_Moles(Moles)
		dKMgO_KMgO, dKSiO2_KSiO2, dKFeO_KFeO, dKMgSiO3_KMgSiO3, dKFeSiO3_KFeSiO3 = dKs
		return M_Mg*(M_Fe*(M_O*(M_FeSiO3*(M_FeO*(M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(4.0*dM_FeSiO3_er + 4.0*dM_MgO_er + 8.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er)) + M_SiO2*M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-4.0*dM_FeO_er - 8.0*dM_FeSiO3_er - 4.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_m*(4.0*dM_FeSiO3_er - 4.0*dM_MgO_er + 4.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er) + M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er)) + M_SiO2*M_m*(M_FeO*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(4.0*dM_FeO_er + 4.0*dM_FeSiO3_er))) + dKFeO_KFeO*(M_O*(M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m))) + M_Si*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - 4.0*M_m) + M_FeSiO3*(9.0*M_FeO - 2.0*M_SiO2 - 10.0*M_m)) + M_MgSiO3*(M_FeO*(9.0*M_MgO - 2.0*M_SiO2 - 10.0*M_m) + M_FeSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m)))) + M_c*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*M_MgO*(-M_FeSiO3 - M_SiO2) + M_MgSiO3*(-M_FeO*M_MgO + M_FeSiO3*(-M_FeO - M_MgO + M_m))) + M_Si*(M_MgO*(M_FeO*(-M_SiO2 + M_m) + M_FeSiO3*(-4.0*M_FeO + M_SiO2 + 3.0*M_m)) + M_MgSiO3*(M_FeO*(-4.0*M_MgO + M_SiO2 + 3.0*M_m) + M_FeSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m)) + M_O*(M_MgO*(-M_FeO - M_FeSiO3) + M_MgSiO3*(-M_FeO - M_FeSiO3)))))) + M_FeSiO3*dKFeSiO3_KFeSiO3*(M_Fe*M_O*(-4.0*M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(-M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_MgO*(-2.0*M_SiO2 - 10.0*M_m) + M_MgSiO3*(9.0*M_FeO + 9.0*M_MgO + 4.0*M_SiO2 - 25.0*M_m))) + M_FeO*M_O*(M_MgO*(-3.0*M_SiO2 - 6.0*M_m) + M_MgSiO3*(6.0*M_SiO2 - 15.0*M_m))) + M_c*(M_Fe*(M_MgO*M_SiO2*M_m + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_O*(-M_FeO - M_MgO + M_m) + M_SiO2*M_m)) + M_FeO*M_O*(M_MgO*M_SiO2 + M_MgSiO3*M_m) + M_Si*(M_Fe*(M_MgO*(M_SiO2 + 3.0*M_m) + M_MgSiO3*(-4.0*M_FeO - 4.0*M_MgO - M_SiO2 + 9.0*M_m) + M_O*(-M_MgO - M_MgSiO3)) + M_FeO*(M_MgO*(2.0*M_SiO2 + 2.0*M_m) + M_MgSiO3*(-2.0*M_SiO2 + 6.0*M_m))))) + M_MgSiO3*dKMgSiO3_KMgSiO3*(M_Fe*M_O*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_Si*(M_Fe*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-3.0*M_SiO2 - 6.0*M_m) + 9.0*M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-3.0*M_SiO2 - 6.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-3.0*M_SiO2 - 6.0*M_m) + 9.0*M_SiO2*M_m))) + M_c*(M_Fe*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m))) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m))) + M_Si*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(2.0*M_SiO2 + 2.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(2.0*M_SiO2 + 2.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(2.0*M_SiO2 + 2.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))) + M_Si*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_MgO*(M_SiO2*(1.0*dM_FeSiO3_er + dM_MgO_er + 2.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(1.0*dM_FeO_er - 1.0*dM_MgSiO3_er - 1.0*dM_SiO2_er)) + M_SiO2*M_m*(-dM_MgO_er - dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgSiO3_er - dM_SiO2_er) + M_m*(1.0*dM_FeSiO3_er - 1.0*dM_MgO_er + 1.0*dM_SiO2_er)) + M_MgO*(M_SiO2*(-1.0*dM_FeO_er - 1.0*dM_FeSiO3_er) + M_m*(1.0*dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(1.0*dM_FeO_er + 1.0*dM_FeSiO3_er)) + M_O*(M_FeO*(M_SiO2*(dM_MgO_er + dM_MgSiO3_er) + M_m*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_MgO*(6.0*dM_FeO_er + 15.0*dM_FeSiO3_er + 15.0*dM_MgO_er + 24.0*dM_MgSiO3_er + 9.0*dM_SiO2_er) + M_SiO2*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er) + M_m*(-25.0*dM_MgO_er - 25.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(2*dM_FeO_er + 5.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(4.0*dM_FeO_er + 10.0*dM_FeSiO3_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(-6.0*dM_FeO_er - 15.0*dM_FeSiO3_er + 3.0*dM_MgO_er - 6.0*dM_MgSiO3_er - 9.0*dM_SiO2_er) + M_MgO*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_FeO_er - 10.0*dM_FeSiO3_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(10.0*dM_FeO_er + 25.0*dM_FeSiO3_er - 15.0*dM_MgO_er + 15.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_SiO2*M_m*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_MgO*(1.0*dM_FeO_er + 1.0*dM_FeSiO3_er))) + M_O*(M_FeO*(M_MgO*(M_SiO2*(3.0*dM_FeO_er + 6.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(6.0*dM_FeSiO3_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(3.0*dM_FeSiO3_er + 3.0*dM_MgO_er + 6.0*dM_MgSiO3_er + 3.0*dM_SiO2_er) + M_m*(-6.0*dM_FeO_er + 6.0*dM_MgSiO3_er + 6.0*dM_SiO2_er)) + M_SiO2*M_m*(-9.0*dM_MgO_er - 9.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_FeO_er - 12.0*dM_FeSiO3_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(15.0*dM_FeSiO3_er - 15.0*dM_MgO_er + 15.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_MgO*(9.0*dM_FeO_er + 9.0*dM_FeSiO3_er + 9.0*dM_MgO_er + 9.0*dM_MgSiO3_er) + M_SiO2*(-6.0*dM_FeSiO3_er - 6.0*dM_MgSiO3_er - 6.0*dM_SiO2_er) + M_m*(-15.0*dM_FeO_er - 15.0*dM_MgO_er + 15.0*dM_SiO2_er)))) + dKSiO2_KSiO2*(M_O*(M_Fe*(M_MgO*(M_FeSiO3*(4.0*M_SiO2 - 10.0*M_m) - 6.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(2.0*M_SiO2 + 4.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgO*(-6.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(6.0*M_SiO2 - 6.0*M_m) + M_MgO*(6.0*M_SiO2 - 6.0*M_m) - 6.0*M_SiO2*M_m))) + M_c*(M_Fe*(M_MgO*(M_FeSiO3*(-M_SiO2 + 3.0*M_m) + 2.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 - M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_O*(M_MgO*(-M_FeSiO3 - M_SiO2) + M_MgSiO3*(M_FeO - M_m))) + M_MgO*(2.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-2.0*M_SiO2 + 2.0*M_m) + M_MgO*(-2.0*M_SiO2 + 2.0*M_m) + 2.0*M_SiO2*M_m)) + M_O*(M_MgO*M_SiO2*(-M_FeO - M_FeSiO3) + M_MgSiO3*M_m*(-M_FeO - M_FeSiO3))))) + M_c*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(-dM_FeO_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er)) + M_SiO2*M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_SiO2*(dM_FeO_er + 2.0*dM_FeSiO3_er + 1.0*dM_MgSiO3_er + 1.0*dM_SiO2_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_MgO*(M_SiO2*(dM_FeO_er + 1.0*dM_FeSiO3_er) + M_m*(-dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_SiO2*M_m*(-dM_FeO_er - 1.0*dM_FeSiO3_er)) + M_O*(M_FeSiO3*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(dM_FeSiO3_er - dM_MgO_er + dM_SiO2_er) + M_MgO*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_SiO2*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_MgO_er + dM_MgSiO3_er))) + M_SiO2*M_m*(M_FeO*(dM_MgO_er + dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - 1.0*dM_FeSiO3_er))) + M_O*(M_FeO*M_SiO2*(M_MgO*(-dM_FeO_er - 2*dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*(M_MgO*(-dM_FeSiO3_er - dM_MgO_er - 2*dM_MgSiO3_er - dM_SiO2_er) + M_m*(dM_MgO_er + dM_MgSiO3_er))) + M_MgSiO3*(M_FeO*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_m*(-dM_FeSiO3_er + dM_MgO_er - dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_FeO_er + dM_MgO_er - dM_SiO2_er)))) + M_Si*(M_Fe*(M_FeO*(M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-2.0*dM_FeO_er - 6.0*dM_FeSiO3_er - 6.0*dM_MgO_er - 10.0*dM_MgSiO3_er - 4.0*dM_SiO2_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(9.0*dM_MgO_er + 9.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-dM_FeO_er - 3.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_MgSiO3*(M_FeO*(2.0*dM_FeO_er + 6.0*dM_FeSiO3_er - 2.0*dM_MgO_er + 2.0*dM_MgSiO3_er + 4.0*dM_SiO2_er) + M_MgO*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(dM_FeO_er + 3.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(-3.0*dM_FeO_er - 9.0*dM_FeSiO3_er + 6.0*dM_MgO_er - 6.0*dM_SiO2_er)) + M_O*(M_FeO*(-dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_MgO_er - dM_MgSiO3_er) + M_MgO*(-dM_MgO_er - dM_MgSiO3_er) + M_MgSiO3*(-dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_FeO*(M_MgO*(M_SiO2*(-2*dM_FeO_er - 4.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(-2.0*dM_FeSiO3_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_FeSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(-4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_MgO*(M_SiO2*(-2.0*dM_FeSiO3_er - 2*dM_MgO_er - 4.0*dM_MgSiO3_er - 2.0*dM_SiO2_er) + M_m*(2.0*dM_FeO_er - 2.0*dM_MgSiO3_er - 2.0*dM_SiO2_er)) + M_SiO2*M_m*(4.0*dM_MgO_er + 4.0*dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(2*dM_FeO_er + 4.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(-6.0*dM_FeSiO3_er + 6.0*dM_MgO_er - 6.0*dM_SiO2_er)) + M_FeSiO3*(M_FeO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_MgO*(-4.0*dM_FeO_er - 4.0*dM_FeSiO3_er - 4.0*dM_MgO_er - 4.0*dM_MgSiO3_er) + M_SiO2*(2.0*dM_FeSiO3_er + 2.0*dM_MgSiO3_er + 2.0*dM_SiO2_er) + M_m*(6.0*dM_FeO_er + 6.0*dM_MgO_er - 6.0*dM_SiO2_er))) + M_O*(M_FeO*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_FeSiO3*(M_MgO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_SiO2*(-dM_MgO_er - dM_MgSiO3_er) + M_m*(dM_MgO_er + dM_MgSiO3_er)) + M_MgSiO3*(M_FeO*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er) + M_FeSiO3*(-dM_FeO_er - dM_FeSiO3_er - dM_MgO_er - dM_MgSiO3_er))))) + dKMgO_KMgO*(M_Fe*M_O*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)))))))/(M_O*(M_Fe*(M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_SiO2*M_m*(4.0*M_FeO + 4.0*M_MgO)) + M_MgO*(4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-4.0*M_SiO2 + 4.0*M_m) + M_MgO*(-4.0*M_SiO2 + 4.0*M_m) + 4.0*M_SiO2*M_m)))) + M_Si*(M_Fe*(M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_O*(M_FeO*(-M_SiO2 + 4.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + M_MgSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + 9.0*M_SiO2*M_m) + M_SiO2*M_m*(M_FeO + M_MgO)) + M_MgO*(M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-M_SiO2 + M_m) + M_MgO*(-M_SiO2 + M_m) + M_SiO2*M_m)) + M_O*(M_FeO*(M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_MgO - 9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-M_SiO2 + 4.0*M_m) + 9.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(-9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m) + M_FeSiO3*(-9.0*M_FeO - 9.0*M_MgO - 4.0*M_SiO2 + 25.0*M_m)))) + M_O*(M_MgO*(9.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(-9.0*M_SiO2 + 9.0*M_m) + M_MgO*(-9.0*M_SiO2 + 9.0*M_m) + 9.0*M_SiO2*M_m)))) + M_c*(M_Fe*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_MgO*(M_FeSiO3*(M_FeO - M_m) + M_SiO2*(M_FeO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO + M_SiO2) + M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Mg*(M_Fe*(M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_O*(M_FeSiO3*(M_FeO + M_MgO - M_m) + M_MgSiO3*(M_FeO + M_MgO - M_m) + M_SiO2*(M_FeO + M_MgO - M_m)) + M_SiO2*M_m*(-M_FeO - M_MgO)) + M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_O*(M_FeO*M_SiO2*(M_MgO - M_m) + M_FeSiO3*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_SiO2*(M_MgO - M_m)) + M_MgSiO3*(M_FeO*(M_MgO - M_m) + M_FeSiO3*(M_FeO + M_MgO - M_m)))) + M_O*(M_MgO*(-M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) - M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m) + M_FeSiO3*(M_FeO*(M_SiO2 - M_m) + M_MgO*(M_SiO2 - M_m) - M_SiO2*M_m))) + M_Si*(M_Fe*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + M_SiO2 - 9.0*M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_O*(M_MgO*(M_FeO + M_FeSiO3 + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3 + M_SiO2 - M_m))) + M_Mg*(M_Fe*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_MgO*(M_SiO2 - M_m) + M_MgSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_O*(M_FeO + M_FeSiO3 + M_MgO + M_MgSiO3 + M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeO*(M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_MgO + 4.0*M_SiO2 - 4.0*M_m) + M_MgO*(M_SiO2 - M_m) - 4.0*M_SiO2*M_m) + M_MgSiO3*(M_FeO*(4.0*M_MgO + M_SiO2 - 9.0*M_m) + M_FeSiO3*(4.0*M_FeO + 4.0*M_MgO + M_SiO2 - 9.0*M_m)) + M_O*(M_FeO*(M_MgO + M_SiO2 - M_m) + M_FeSiO3*(M_MgO + M_SiO2 - M_m) + M_MgSiO3*(M_FeO + M_FeSiO3))) + M_MgO*(-4.0*M_FeO*M_SiO2*M_m + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_MgSiO3*(M_FeO*(M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m) + M_FeSiO3*(M_FeO*(4.0*M_SiO2 - 4.0*M_m) + M_MgO*(4.0*M_SiO2 - 4.0*M_m) - 4.0*M_SiO2*M_m)) + M_O*(M_MgO*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m)) + M_MgSiO3*(M_FeO*(M_SiO2 - M_m) + M_FeSiO3*(M_SiO2 - M_m))))))

